"use strict";(self.webpackChunkreact_navigation_website_next=self.webpackChunkreact_navigation_website_next||[]).push([["77132"],{30638:function(e,n,i){i.r(n),i.d(n,{metadata:()=>t,contentTitle:()=>r,default:()=>h,assets:()=>d,toc:()=>l,frontMatter:()=>s});var t=JSON.parse('{"id":"deep-linking","title":"Deep linking","description":"This guide will describe how to configure your app to handle deep links on various platforms. To handle incoming links, you need to handle 2 scenarios:","source":"@site/versioned_docs/version-6.x/deep-linking.md","sourceDirName":".","slug":"/deep-linking","permalink":"/docs/6.x/deep-linking","draft":false,"unlisted":false,"editUrl":"https://github.com/react-navigation/react-navigation.github.io/edit/main/versioned_docs/version-6.x/deep-linking.md","tags":[],"version":"6.x","frontMatter":{"id":"deep-linking","title":"Deep linking","sidebar_label":"Deep linking"},"sidebar":"docs","previous":{"title":"Navigating without the navigation prop","permalink":"/docs/6.x/navigating-without-navigation-prop"},"next":{"title":"Configuring links","permalink":"/docs/6.x/configuring-links"}}'),o=i("85893"),a=i("50065");let s={id:"deep-linking",title:"Deep linking",sidebar_label:"Deep linking"},r=void 0,d={},l=[{value:"Setup with Expo projects",id:"setup-with-expo-projects",level:2},{value:"Set up with bare React Native projects",id:"set-up-with-bare-react-native-projects",level:2},{value:"Setup on iOS",id:"setup-on-ios",level:3},{value:"Hybrid React Native and native iOS Applications",id:"hybrid-react-native-and-native-ios-applications",level:4},{value:"Setup on Android",id:"setup-on-android",level:3},{value:"Testing deep links",id:"testing-deep-links",level:2},{value:"Testing with <code>npx uri-scheme</code>",id:"testing-with-npx-uri-scheme",level:3},{value:"Testing with <code>xcrun</code> on iOS",id:"testing-with-xcrun-on-ios",level:3},{value:"Testing with <code>adb</code> on Android",id:"testing-with-adb-on-android",level:3},{value:"Third-party integrations",id:"third-party-integrations",level:2}];function c(e){let n={a:"a",code:"code",h2:"h2",h3:"h3",h4:"h4",img:"img",li:"li",ol:"ol",p:"p",pre:"pre",...(0,a.a)(),...e.components};return(0,o.jsxs)(o.Fragment,{children:[(0,o.jsx)(n.p,{children:"This guide will describe how to configure your app to handle deep links on various platforms. To handle incoming links, you need to handle 2 scenarios:"}),"\n",(0,o.jsxs)(n.ol,{children:["\n",(0,o.jsx)(n.li,{children:"If the app wasn't previously open, the deep link needs to set the initial state"}),"\n",(0,o.jsx)(n.li,{children:"If the app was already open, the deep link needs to update the state to reflect the incoming link"}),"\n"]}),"\n",(0,o.jsxs)(n.p,{children:["React Native provides a ",(0,o.jsx)(n.a,{href:"https://reactnative.dev/docs/linking",children:(0,o.jsx)(n.code,{children:"Linking"})})," to get notified of incoming links. React Navigation can integrate with the ",(0,o.jsx)(n.code,{children:"Linking"})," module to automatically handle deep links. On Web, React Navigation can integrate with browser's ",(0,o.jsx)(n.code,{children:"history"})," API to handle URLs on client side. See ",(0,o.jsx)(n.a,{href:"/docs/6.x/configuring-links",children:"configuring links"})," to see more details on how to configure links in React Navigation."]}),"\n",(0,o.jsxs)(n.p,{children:["While you don't need to use the ",(0,o.jsx)(n.code,{children:"linking"})," prop from React Navigation, and can handle deep links yourself by using the ",(0,o.jsx)(n.code,{children:"Linking"})," API and navigating from there, it'll be significantly more complicated than using the ",(0,o.jsx)(n.code,{children:"linking"})," prop which handles many edge cases for you. So we don't recommend implementing it by yourself."]}),"\n",(0,o.jsx)(n.p,{children:"Below, we'll go through required configurations so that the deep link integration works."}),"\n",(0,o.jsx)(n.h2,{id:"setup-with-expo-projects",children:"Setup with Expo projects"}),"\n",(0,o.jsxs)(n.p,{children:["First, you will want to specify a URL scheme for your app. This corresponds to the string before ",(0,o.jsx)(n.code,{children:"://"})," in a URL, so if your scheme is ",(0,o.jsx)(n.code,{children:"example"})," then a link to your app would be ",(0,o.jsx)(n.code,{children:"example://"}),". You can register for a scheme in your ",(0,o.jsx)(n.code,{children:"app.json"})," by adding a string under the scheme key:"]}),"\n",(0,o.jsx)(n.pre,{children:(0,o.jsx)(n.code,{className:"language-json",children:'{\n  "expo": {\n    "scheme": "example"\n  }\n}\n'})}),"\n",(0,o.jsxs)(n.p,{children:["Next, install ",(0,o.jsx)(n.code,{children:"expo-linking"})," which we'd need to get the deep link prefix:"]}),"\n",(0,o.jsx)(n.pre,{children:(0,o.jsx)(n.code,{className:"language-bash",children:"npx expo install expo-linking\n"})}),"\n",(0,o.jsxs)(n.p,{children:["Then, let's configure React Navigation to use the ",(0,o.jsx)(n.code,{children:"scheme"})," for parsing incoming deep links:"]}),"\n",(0,o.jsx)(n.pre,{children:(0,o.jsx)(n.code,{className:"language-js",children:"import * as Linking from 'expo-linking';\n\nconst prefix = Linking.createURL('/');\n\nfunction App() {\n  const linking = {\n    prefixes: [prefix],\n  };\n\n  return (\n    <NavigationContainer linking={linking} fallback={<Text>Loading...</Text>}>\n      {/* content */}\n    </NavigationContainer>\n  );\n}\n"})}),"\n",(0,o.jsxs)(n.p,{children:["The reason that is necessary to use ",(0,o.jsx)(n.code,{children:"Linking.createURL"})," is that the scheme will differ depending on whether you're in the client app or in a standalone app."]}),"\n",(0,o.jsxs)(n.p,{children:["The scheme specified in ",(0,o.jsx)(n.code,{children:"app.json"})," only applies to standalone apps. In the Expo client app you can deep link using ",(0,o.jsx)(n.code,{children:"exp://ADDRESS:PORT/--/"})," where ",(0,o.jsx)(n.code,{children:"ADDRESS"})," is often ",(0,o.jsx)(n.code,{children:"127.0.0.1"})," and ",(0,o.jsx)(n.code,{children:"PORT"})," is often ",(0,o.jsx)(n.code,{children:"19000"})," - the URL is printed when you run ",(0,o.jsx)(n.code,{children:"expo start"}),". The ",(0,o.jsx)(n.code,{children:"Linking.createURL"})," function abstracts it out so that you don't need to specify them manually."]}),"\n",(0,o.jsx)(n.p,{children:"If you are using universal links, you need to add your domain to the prefixes as well:"}),"\n",(0,o.jsx)(n.pre,{children:(0,o.jsx)(n.code,{className:"language-js",children:"const linking = {\n  prefixes: [Linking.createURL('/'), 'https://app.example.com'],\n};\n"})}),"\n",(0,o.jsx)(n.h2,{id:"set-up-with-bare-react-native-projects",children:"Set up with bare React Native projects"}),"\n",(0,o.jsx)(n.h3,{id:"setup-on-ios",children:"Setup on iOS"}),"\n",(0,o.jsxs)(n.p,{children:["Let's configure the native iOS app to open based on the ",(0,o.jsx)(n.code,{children:"example://"})," URI scheme."]}),"\n",(0,o.jsxs)(n.p,{children:["You'll need to link ",(0,o.jsx)(n.code,{children:"RCTLinking"})," to your project by following the steps described here. To be able to listen to incoming app links, you'll need to add the following lines to ",(0,o.jsx)(n.code,{children:"AppDelegate.m"})," in your project:"]}),"\n",(0,o.jsx)(n.pre,{children:(0,o.jsx)(n.code,{className:"language-objc",children:"// Add the header at the top of the file:\n#import <React/RCTLinkingManager.h>\n\n// Add this inside `@implementation AppDelegate` above `@end`:\n- (BOOL)application:(UIApplication *)application\n   openURL:(NSURL *)url\n   options:(NSDictionary<UIApplicationOpenURLOptionsKey,id> *)options\n{\n  return [RCTLinkingManager application:application openURL:url options:options];\n}\n"})}),"\n",(0,o.jsxs)(n.p,{children:["If your app is using ",(0,o.jsx)(n.a,{href:"https://developer.apple.com/ios/universal-links/",children:"Universal Links"}),", you'll need to add the following code as well:"]}),"\n",(0,o.jsx)(n.pre,{children:(0,o.jsx)(n.code,{className:"language-objc",children:"// Add this inside `@implementation AppDelegate` above `@end`:\n- (BOOL)application:(UIApplication *)application continueUserActivity:(nonnull NSUserActivity *)userActivity\n restorationHandler:(nonnull void (^)(NSArray<id<UIUserActivityRestoring>> * _Nullable))restorationHandler\n{\n return [RCTLinkingManager application:application\n                  continueUserActivity:userActivity\n                    restorationHandler:restorationHandler];\n}\n"})}),"\n",(0,o.jsx)(n.p,{children:"Now you need to add the scheme to your project configuration."}),"\n",(0,o.jsxs)(n.p,{children:["The easiest way to do this is with the ",(0,o.jsx)(n.code,{children:"uri-scheme"})," package by running the following:"]}),"\n",(0,o.jsx)(n.pre,{children:(0,o.jsx)(n.code,{className:"language-bash",children:"npx uri-scheme add example --ios\n"})}),"\n",(0,o.jsxs)(n.p,{children:["If you want to do it manually, open the project (e.g. ",(0,o.jsx)(n.code,{children:"SimpleApp/ios/SimpleApp.xcworkspace"}),') in Xcode. Select the project in sidebar and navigate to the info tab. Scroll down to "URL Types" and add one. In the new URL type, set the identifier and the URL scheme to your desired URL scheme.']}),"\n",(0,o.jsx)(n.p,{children:(0,o.jsx)(n.img,{alt:"Xcode project info URL types with example added",src:i(40801).Z+"",width:"1098",height:"560"})}),"\n",(0,o.jsxs)(n.p,{children:["To make sure Universal Links work in your app, you also need to setup ",(0,o.jsx)(n.a,{href:"https://developer.apple.com/documentation/Xcode/supporting-associated-domains",children:"Associated Domains"})," on your server."]}),"\n",(0,o.jsx)(n.h4,{id:"hybrid-react-native-and-native-ios-applications",children:"Hybrid React Native and native iOS Applications"}),"\n",(0,o.jsxs)(n.p,{children:["If you're using React Navigation within a hybrid app - an iOS app that has both Swift/ObjC and React Native parts - you may be missing the ",(0,o.jsx)(n.code,{children:"RCTLinkingIOS"})," subspec in your ",(0,o.jsx)(n.code,{children:"Podfile"}),", which is installed by default in new React Native projects. To add this, ensure your ",(0,o.jsx)(n.code,{children:"Podfile"})," looks like the following:"]}),"\n",(0,o.jsx)(n.pre,{children:(0,o.jsx)(n.code,{className:"language-pod",children:" pod 'React', :path => '../node_modules/react-native', :subspecs => [\n    . . . // other subspecs\n    'RCTLinkingIOS',\n    . . .\n  ]\n"})}),"\n",(0,o.jsx)(n.h3,{id:"setup-on-android",children:"Setup on Android"}),"\n",(0,o.jsx)(n.p,{children:"To configure the external linking in Android, you can create a new intent in the manifest."}),"\n",(0,o.jsxs)(n.p,{children:["The easiest way to do this is with the ",(0,o.jsx)(n.code,{children:"uri-scheme"})," package: ",(0,o.jsx)(n.code,{children:"npx uri-scheme add example --android"}),"."]}),"\n",(0,o.jsxs)(n.p,{children:["If you want to add it manually, open up ",(0,o.jsx)(n.code,{children:"SimpleApp/android/app/src/main/AndroidManifest.xml"}),", and make the following adjustments:"]}),"\n",(0,o.jsxs)(n.ol,{children:["\n",(0,o.jsxs)(n.li,{children:["Set ",(0,o.jsx)(n.code,{children:"launchMode"})," of ",(0,o.jsx)(n.code,{children:"MainActivity"})," to ",(0,o.jsx)(n.code,{children:"singleTask"})," in order to receive intent on existing ",(0,o.jsx)(n.code,{children:"MainActivity"})," (this is the default, so you may not need to actually change anything)."]}),"\n",(0,o.jsxs)(n.li,{children:["Add the new ",(0,o.jsx)(n.a,{href:"http://developer.android.com/training/app-indexing/deep-linking.html#adding-filters",children:(0,o.jsx)(n.code,{children:"intent-filter"})})," inside the ",(0,o.jsx)(n.code,{children:"MainActivity"})," entry with a ",(0,o.jsx)(n.code,{children:"VIEW"})," type action:"]}),"\n"]}),"\n",(0,o.jsx)(n.pre,{children:(0,o.jsx)(n.code,{className:"language-xml",children:'<activity\n    android:name=".MainActivity"\n    android:launchMode="singleTask">\n    <intent-filter>\n        <action android:name="android.intent.action.MAIN" />\n        <category android:name="android.intent.category.LAUNCHER" />\n    </intent-filter>\n    <intent-filter>\n        <action android:name="android.intent.action.VIEW" />\n        <category android:name="android.intent.category.DEFAULT" />\n        <category android:name="android.intent.category.BROWSABLE" />\n        <data android:scheme="example" />\n    </intent-filter>\n</activity>\n'})}),"\n",(0,o.jsxs)(n.p,{children:["Similar to Universal Links on iOS, you can also use a domain to associate the app with your website on Android by ",(0,o.jsx)(n.a,{href:"https://developer.android.com/training/app-links/verify-android-applinks",children:"verifying Android App Links"}),". First, you need to configure your ",(0,o.jsx)(n.code,{children:"AndroidManifest.xml"}),":"]}),"\n",(0,o.jsxs)(n.ol,{children:["\n",(0,o.jsxs)(n.li,{children:["Add ",(0,o.jsx)(n.code,{children:'android:autoVerify="true"'})," to your ",(0,o.jsx)(n.code,{children:"<intent-filter>"})," entry."]}),"\n",(0,o.jsxs)(n.li,{children:["Add your domain's ",(0,o.jsx)(n.code,{children:"scheme"})," and ",(0,o.jsx)(n.code,{children:"host"})," in a new ",(0,o.jsx)(n.code,{children:"<data>"})," entry inside the ",(0,o.jsx)(n.code,{children:"<intent-filter>"}),"."]}),"\n"]}),"\n",(0,o.jsx)(n.p,{children:"After adding them, it should look like this:"}),"\n",(0,o.jsx)(n.pre,{children:(0,o.jsx)(n.code,{className:"language-xml",children:'<activity\n    android:name=".MainActivity"\n    android:launchMode="singleTask">\n    <intent-filter android:autoVerify="true">\n        <action android:name="android.intent.action.MAIN" />\n        <category android:name="android.intent.category.LAUNCHER" />\n    </intent-filter>\n    <intent-filter>\n        <action android:name="android.intent.action.VIEW" />\n        <category android:name="android.intent.category.DEFAULT" />\n        <category android:name="android.intent.category.BROWSABLE" />\n        <data android:scheme="example" />\n    </intent-filter>\n    <intent-filter>\n        <action android:name="android.intent.action.VIEW" />\n        <category android:name="android.intent.category.DEFAULT" />\n        <category android:name="android.intent.category.BROWSABLE" />\n        <data android:scheme="http" />\n        <data android:scheme="https" />\n        <data android:host="www.example.com" />\n    </intent-filter>\n</activity>\n'})}),"\n",(0,o.jsxs)(n.p,{children:["Then, you need to ",(0,o.jsx)(n.a,{href:"https://developer.android.com/training/app-links/verify-android-applinks#web-assoc",children:"declare the association"})," between your website and your intent filters by hosting a Digital Asset Links JSON file."]}),"\n",(0,o.jsx)(n.h2,{id:"testing-deep-links",children:"Testing deep links"}),"\n",(0,o.jsx)(n.p,{children:"Before testing deep links, make sure that you rebuild and install the app in your emulator/simulator/device."}),"\n",(0,o.jsx)(n.p,{children:"If you're testing on iOS, run:"}),"\n",(0,o.jsx)(n.pre,{children:(0,o.jsx)(n.code,{className:"language-bash",children:"npx react-native run-ios\n"})}),"\n",(0,o.jsx)(n.p,{children:"If you're testing on Android, run:"}),"\n",(0,o.jsx)(n.pre,{children:(0,o.jsx)(n.code,{className:"language-bash",children:"npx react-native run-android\n"})}),"\n",(0,o.jsxs)(n.p,{children:["If you're using Expo managed workflow and testing on Expo client, you don't need to rebuild the app. However, you will need to use the correct address and port that's printed when you run ",(0,o.jsx)(n.code,{children:"expo start"})," (",(0,o.jsx)(n.a,{href:"#setup-with-expo-projects",children:"see above"}),"), e.g. ",(0,o.jsx)(n.code,{children:"exp://127.0.0.1:19000/--/"}),"."]}),"\n",(0,o.jsxs)(n.p,{children:["If you want to test with your custom scheme in your Expo app, you will need rebuild your standalone app by running ",(0,o.jsx)(n.code,{children:"expo build:ios -t simulator"})," or ",(0,o.jsx)(n.code,{children:"expo build:android"})," and install the resulting binaries."]}),"\n",(0,o.jsxs)(n.h3,{id:"testing-with-npx-uri-scheme",children:["Testing with ",(0,o.jsx)(n.code,{children:"npx uri-scheme"})]}),"\n",(0,o.jsxs)(n.p,{children:["The ",(0,o.jsx)(n.code,{children:"uri-scheme"})," package is a command line tool that can be used to test deep links on both iOS & Android. It can be used as follows:"]}),"\n",(0,o.jsx)(n.pre,{children:(0,o.jsx)(n.code,{className:"language-bash",children:"npx uri-scheme open [your deep link] --[ios|android]\n"})}),"\n",(0,o.jsx)(n.p,{children:"For example:"}),"\n",(0,o.jsx)(n.pre,{children:(0,o.jsx)(n.code,{className:"language-bash",children:'npx uri-scheme open "example://chat/jane" --ios\n'})}),"\n",(0,o.jsx)(n.p,{children:"Or if using Expo client:"}),"\n",(0,o.jsx)(n.pre,{children:(0,o.jsx)(n.code,{className:"language-bash",children:'npx uri-scheme open "exp://127.0.0.1:19000/--/chat/jane" --ios\n'})}),"\n",(0,o.jsxs)(n.h3,{id:"testing-with-xcrun-on-ios",children:["Testing with ",(0,o.jsx)(n.code,{children:"xcrun"})," on iOS"]}),"\n",(0,o.jsxs)(n.p,{children:["The ",(0,o.jsx)(n.code,{children:"xcrun"})," command can be used as follows to test deep links with the iOS simulator:"]}),"\n",(0,o.jsx)(n.pre,{children:(0,o.jsx)(n.code,{className:"language-bash",children:"xcrun simctl openurl booted [your deep link]\n"})}),"\n",(0,o.jsx)(n.p,{children:"For example:"}),"\n",(0,o.jsx)(n.pre,{children:(0,o.jsx)(n.code,{className:"language-bash",children:'xcrun simctl openurl booted "example://chat/jane"\n'})}),"\n",(0,o.jsxs)(n.h3,{id:"testing-with-adb-on-android",children:["Testing with ",(0,o.jsx)(n.code,{children:"adb"})," on Android"]}),"\n",(0,o.jsxs)(n.p,{children:["The ",(0,o.jsx)(n.code,{children:"adb"})," command can be used as follows to test deep links with the Android emulator or a connected device:"]}),"\n",(0,o.jsx)(n.pre,{children:(0,o.jsx)(n.code,{className:"language-bash",children:"adb shell am start -W -a android.intent.action.VIEW -d [your deep link] [your android package name]\n"})}),"\n",(0,o.jsx)(n.p,{children:"For example:"}),"\n",(0,o.jsx)(n.pre,{children:(0,o.jsx)(n.code,{className:"language-bash",children:'adb shell am start -W -a android.intent.action.VIEW -d "example://chat/jane" com.simpleapp\n'})}),"\n",(0,o.jsx)(n.p,{children:"Or if using Expo client:"}),"\n",(0,o.jsx)(n.pre,{children:(0,o.jsx)(n.code,{className:"language-bash",children:'adb shell am start -W -a android.intent.action.VIEW -d "exp://127.0.0.1:19000/--/chat/jane" host.exp.exponent\n'})}),"\n",(0,o.jsx)(n.h2,{id:"third-party-integrations",children:"Third-party integrations"}),"\n",(0,o.jsxs)(n.p,{children:["React Native's ",(0,o.jsx)(n.code,{children:"Linking"})," isn't the only way to handle deep linking. You might also want to integrate other services such as ",(0,o.jsx)(n.a,{href:"https://firebase.google.com/docs/dynamic-links",children:"Firebase Dynamic Links"}),", ",(0,o.jsx)(n.a,{href:"https://help.branch.io/developers-hub/docs/react-native",children:"Branch"})," etc. which provide their own API for getting notified of incoming links."]}),"\n",(0,o.jsxs)(n.p,{children:["To achieve this, you'd need to override how React Navigation subscribes to incoming links. To do so, you can provide your own ",(0,o.jsx)(n.a,{href:"/docs/6.x/navigation-container#linkinggetinitialurl",children:(0,o.jsx)(n.code,{children:"getInitialURL"})})," and ",(0,o.jsx)(n.a,{href:"/docs/6.x/navigation-container#linkingsubscribe",children:(0,o.jsx)(n.code,{children:"subscribe"})})," functions:"]}),"\n",(0,o.jsx)(n.pre,{children:(0,o.jsx)(n.code,{className:"language-js",children:"const linking = {\n  prefixes: ['myapp://', 'https://myapp.com'],\n\n  // Custom function to get the URL which was used to open the app\n  async getInitialURL() {\n    // First, you would need to get the initial URL from your third-party integration\n    // The exact usage depend on the third-party SDK you use\n    // For example, to get the initial URL for Firebase Dynamic Links:\n    const { isAvailable } = utils().playServicesAvailability;\n\n    if (isAvailable) {\n      const initialLink = await dynamicLinks().getInitialLink();\n\n      if (initialLink) {\n        return initialLink.url;\n      }\n    }\n\n    // As a fallback, you may want to do the default deep link handling\n    const url = await Linking.getInitialURL();\n\n    return url;\n  },\n\n  // Custom function to subscribe to incoming links\n  subscribe(listener) {\n    // Listen to incoming links from Firebase Dynamic Links\n    const unsubscribeFirebase = dynamicLinks().onLink(({ url }) => {\n      listener(url);\n    });\n\n    // Listen to incoming links from deep linking\n    const linkingSubscription = Linking.addEventListener('url', ({ url }) => {\n      listener(url);\n    });\n\n    return () => {\n      // Clean up the event listeners\n      unsubscribeFirebase();\n      linkingSubscription.remove();\n    };\n  },\n\n  config: {\n    // Deep link configuration\n  },\n};\n"})}),"\n",(0,o.jsxs)(n.p,{children:["Similar to the above example, you can integrate any API that provides a way to get the initial URL and to subscribe to new incoming URLs using the ",(0,o.jsx)(n.code,{children:"getInitialURL"})," and ",(0,o.jsx)(n.code,{children:"subscribe"})," options."]})]})}function h(e={}){let{wrapper:n}={...(0,a.a)(),...e.components};return n?(0,o.jsx)(n,{...e,children:(0,o.jsx)(c,{...e})}):c(e)}},40801:function(e,n,i){i.d(n,{Z:function(){return t}});let t=i.p+"assets/images/xcode-linking-9a32c91fae982fab28dc33e7f951e8b3.png"},50065:function(e,n,i){i.d(n,{Z:function(){return r},a:function(){return s}});var t=i(67294);let o={},a=t.createContext(o);function s(e){let n=t.useContext(a);return t.useMemo(function(){return"function"==typeof e?e(n):{...n,...e}},[n,e])}function r(e){let n;return n=e.disableParentContext?"function"==typeof e.components?e.components(o):e.components||o:s(e.components),t.createElement(a.Provider,{value:n},e.children)}}}]);