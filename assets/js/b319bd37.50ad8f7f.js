"use strict";(self.webpackChunkreact_navigation_website_next=self.webpackChunkreact_navigation_website_next||[]).push([["13825"],{56131:function(e,n,i){i.r(n),i.d(n,{metadata:()=>t,contentTitle:()=>s,default:()=>p,assets:()=>l,toc:()=>d,frontMatter:()=>r});var t=JSON.parse('{"id":"deep-linking","title":"Deep linking","description":"In this guide, we will configure our app to handle deep links on various platforms. To handle incoming links, we need to handle 2 scenarios:","source":"@site/versioned_docs/version-5.x/deep-linking.md","sourceDirName":".","slug":"/deep-linking","permalink":"/docs/5.x/deep-linking","draft":false,"unlisted":false,"editUrl":"https://github.com/react-navigation/react-navigation.github.io/edit/main/versioned_docs/version-5.x/deep-linking.md","tags":[],"version":"5.x","frontMatter":{"id":"deep-linking","title":"Deep linking","sidebar_label":"Deep linking"},"sidebar":"docs","previous":{"title":"Navigating without the navigation prop","permalink":"/docs/5.x/navigating-without-navigation-prop"},"next":{"title":"Configuring links","permalink":"/docs/5.x/configuring-links"}}'),o=i("85893"),a=i("50065");let r={id:"deep-linking",title:"Deep linking",sidebar_label:"Deep linking"},s=void 0,l={},d=[{value:"Set up with Expo projects",id:"set-up-with-expo-projects",level:2},{value:"URI Prefix",id:"uri-prefix",level:3},{value:"Universal Links",id:"universal-links",level:3},{value:"Multiple subdomains",id:"multiple-subdomains",level:3},{value:"Test deep linking on iOS",id:"test-deep-linking-on-ios",level:3},{value:"Test deep linking on Android",id:"test-deep-linking-on-android",level:3},{value:"Set up with bare React Native projects",id:"set-up-with-bare-react-native-projects",level:2},{value:"iOS",id:"ios",level:3},{value:"Android",id:"android",level:3},{value:"Hybrid React Native and native iOS Applications (skip for React-Native-only projects)",id:"hybrid-react-native-and-native-ios-applications-skip-for-react-native-only-projects",level:2},{value:"Third-party integrations",id:"third-party-integrations",level:2}];function c(e){let n={a:"a",code:"code",h2:"h2",h3:"h3",img:"img",li:"li",ol:"ol",p:"p",pre:"pre",strong:"strong",...(0,a.a)(),...e.components};return(0,o.jsxs)(o.Fragment,{children:[(0,o.jsx)(n.p,{children:"In this guide, we will configure our app to handle deep links on various platforms. To handle incoming links, we need to handle 2 scenarios:"}),"\n",(0,o.jsxs)(n.ol,{children:["\n",(0,o.jsx)(n.li,{children:"If the app wasn't previously open, we need to set the initial state based on the link"}),"\n",(0,o.jsx)(n.li,{children:"If the app was already open, we need to update the state to reflect the incoming link"}),"\n"]}),"\n",(0,o.jsxs)(n.p,{children:["React Native provides a ",(0,o.jsx)(n.a,{href:"https://reactnative.dev/docs/linking",children:(0,o.jsx)(n.code,{children:"Linking"})})," to get notified of incoming links. React Navigation can integrate with the ",(0,o.jsx)(n.code,{children:"Linking"})," module to automatically handle deep links. See ",(0,o.jsx)(n.a,{href:"/docs/5.x/configuring-links",children:"configuring links"})," to see more details on how to configure links in React Navigation."]}),"\n",(0,o.jsx)(n.p,{children:"Below, we'll go through required configurations for each platform so that the deep link integration works."}),"\n",(0,o.jsx)(n.h2,{id:"set-up-with-expo-projects",children:"Set up with Expo projects"}),"\n",(0,o.jsxs)(n.p,{children:["First, you will want to specify a URL scheme for your app. This corresponds to the string before ",(0,o.jsx)(n.code,{children:"://"})," in a URL, so if your scheme is ",(0,o.jsx)(n.code,{children:"example"})," then a link to your app would be ",(0,o.jsx)(n.code,{children:"example://"}),". The scheme only applies to standalone apps and you need to re-build the standalone app for the change to take effect. In the Expo client app you can deep link using ",(0,o.jsx)(n.code,{children:"exp://ADDRESS:PORT"})," where ",(0,o.jsx)(n.code,{children:"ADDRESS"})," is often ",(0,o.jsx)(n.code,{children:"127.0.0.1"})," and ",(0,o.jsx)(n.code,{children:"PORT"})," is often ",(0,o.jsx)(n.code,{children:"19000"})," - the URL is printed when you run ",(0,o.jsx)(n.code,{children:"expo start"}),". If you want to test with your custom scheme you will need to run ",(0,o.jsx)(n.code,{children:"expo build:ios -t simulator"})," or ",(0,o.jsx)(n.code,{children:"expo build:android"})," and install the resulting binaries in your emulators. You can register for a scheme in your ",(0,o.jsx)(n.code,{children:"app.json"})," by adding a string under the scheme key:"]}),"\n",(0,o.jsx)(n.pre,{children:(0,o.jsx)(n.code,{className:"language-json",children:'{\n  "expo": {\n    "scheme": "example"\n  }\n}\n'})}),"\n",(0,o.jsx)(n.h3,{id:"uri-prefix",children:"URI Prefix"}),"\n",(0,o.jsx)(n.p,{children:"Next, let's configure our navigation container to extract the path from the app's incoming URI."}),"\n",(0,o.jsx)(n.pre,{children:(0,o.jsx)(n.code,{className:"language-js",children:"// Install this package with `npx expo install expo-linking`\nimport * as Linking from 'expo-linking';\n\n// Linking.createURL is available as of expo@40.0.1 and expo-linking@2.0.1. If\n// you are using older versions, you can upgrade or use Linking.makeUrl instead,\n// but note that your deep links in standalone apps will be in the format\n// scheme:/// rather than scheme:// if you use makeUrl.\nconst prefix = Linking.createURL('/');\n\nfunction App() {\n  const linking = {\n    prefixes: [prefix],\n  };\n\n  return (\n    <NavigationContainer linking={linking} fallback={<Text>Loading...</Text>}>\n      {/* content */}\n    </NavigationContainer>\n  );\n}\n"})}),"\n",(0,o.jsxs)(n.p,{children:["The reason that is necessary to use ",(0,o.jsx)(n.code,{children:"Linking.createURL"})," is that the scheme will differ depending on whether you're in the client app or in a standalone app."]}),"\n",(0,o.jsx)(n.h3,{id:"universal-links",children:"Universal Links"}),"\n",(0,o.jsx)(n.p,{children:"If you are using universal links, you need to add your domain to the prefixes."}),"\n",(0,o.jsx)(n.pre,{children:(0,o.jsx)(n.code,{className:"language-js",children:"function App() {\n  const linking = {\n    prefixes: ['https://app.example.com'],\n  };\n\n  return (\n    <NavigationContainer linking={linking} fallback={<Text>Loading...</Text>}>\n      {/* content */}\n    </NavigationContainer>\n  );\n}\n"})}),"\n",(0,o.jsxs)(n.p,{children:[(0,o.jsx)(n.strong,{children:"Note:"})," If you are using Expo SDK version 37 or lower, you need to add your domain with both the ",(0,o.jsx)(n.code,{children:"https"})," and ",(0,o.jsx)(n.code,{children:"exps"})," scheme, to work around ",(0,o.jsx)(n.a,{href:"https://github.com/expo/expo/issues/6609",children:"this bug in Expo"}),"."]}),"\n",(0,o.jsx)(n.pre,{children:(0,o.jsx)(n.code,{className:"language-diff",children:"   const linking = {\n-    prefixes: ['https://app.example.com'],\n+    prefixes: ['https://app.example.com', 'exps://app.example.com'],\n   };\n"})}),"\n",(0,o.jsx)(n.h3,{id:"multiple-subdomains",children:"Multiple subdomains"}),"\n",(0,o.jsxs)(n.p,{children:["To match all subdomains of an associated domain, you can specify a wildcard by prefixing ",(0,o.jsx)(n.code,{children:"*."})," before the beginning of a specific domain. Note that an entry for ",(0,o.jsx)(n.code,{children:"*.example.com"})," does not match ",(0,o.jsx)(n.code,{children:"example.com"})," because of the period after the asterisk. To enable matching for both ",(0,o.jsx)(n.code,{children:"*.example.com"})," and ",(0,o.jsx)(n.code,{children:"example.com"}),", you need to provide a separate prefix entry for each."]}),"\n",(0,o.jsx)(n.pre,{children:(0,o.jsx)(n.code,{className:"language-js",children:"const linking = {\n  prefixes: ['https://*.example.com', 'https://example.com'],\n};\n"})}),"\n",(0,o.jsx)(n.h3,{id:"test-deep-linking-on-ios",children:"Test deep linking on iOS"}),"\n",(0,o.jsx)(n.p,{children:"To test the URI on the simulator in the Expo client app, run the following:"}),"\n",(0,o.jsx)(n.pre,{children:(0,o.jsx)(n.code,{className:"language-bash",children:"npx uri-scheme open [ put your uri prefix in here] --ios\n\n# for example\n\nnpx uri-scheme open exp://127.0.0.1:19000/--/chat/jan --ios\n"})}),"\n",(0,o.jsxs)(n.p,{children:["or use ",(0,o.jsx)(n.code,{children:"xcrun"})," directly:"]}),"\n",(0,o.jsx)(n.pre,{children:(0,o.jsx)(n.code,{className:"language-bash",children:"xcrun simctl openurl booted [ put your URI prefix in here ]\n\n# for example\n\nxcrun simctl openurl booted exp://127.0.0.1:19000/--/chat/jane\n"})}),"\n",(0,o.jsx)(n.h3,{id:"test-deep-linking-on-android",children:"Test deep linking on Android"}),"\n",(0,o.jsx)(n.p,{children:"To test the intent handling in the Expo client app on Android, run the following:"}),"\n",(0,o.jsx)(n.pre,{children:(0,o.jsx)(n.code,{className:"language-bash",children:'npx uri-scheme open "[ put your URI prefix in here ]" --/chat/jan --android\n\n# for example\n\nnpx uri-scheme open exp://127.0.0.1:19000/--/chat/jan --android\n'})}),"\n",(0,o.jsxs)(n.p,{children:["or use ",(0,o.jsx)(n.code,{children:"adb"})," directly:"]}),"\n",(0,o.jsx)(n.pre,{children:(0,o.jsx)(n.code,{className:"language-bash",children:'adb shell am start -W -a android.intent.action.VIEW -d "[ put your URI prefix in here ]" host.exp.exponent\n\n# for example\n\nadb shell am start -W -a android.intent.action.VIEW -d "exp://127.0.0.1:19000/--/chat/jane" host.exp.exponent\n'})}),"\n",(0,o.jsxs)(n.p,{children:["Change ",(0,o.jsx)(n.code,{children:"host.exp.exponent"})," to your app package name if you are testing on a standalone app."]}),"\n",(0,o.jsxs)(n.p,{children:["Read the ",(0,o.jsx)(n.a,{href:"https://docs.expo.io/versions/latest/guides/linking.html",children:"Expo linking guide"})," for more information about how to configure linking in projects built with Expo."]}),"\n",(0,o.jsx)(n.h2,{id:"set-up-with-bare-react-native-projects",children:"Set up with bare React Native projects"}),"\n",(0,o.jsx)(n.h3,{id:"ios",children:"iOS"}),"\n",(0,o.jsxs)(n.p,{children:["Let's configure the native iOS app to open based on the ",(0,o.jsx)(n.code,{children:"example://"})," URI scheme."]}),"\n",(0,o.jsxs)(n.p,{children:["You'll need to link ",(0,o.jsx)(n.code,{children:"RCTLinking"})," to your project by following the steps described here. To be able to listen to incoming app links, you'll need to add the following lines to ",(0,o.jsx)(n.code,{children:"SimpleApp/ios/SimpleApp/AppDelegate.m"}),"."]}),"\n",(0,o.jsx)(n.p,{children:"If you're targeting iOS 9.x or newer:"}),"\n",(0,o.jsx)(n.pre,{children:(0,o.jsx)(n.code,{className:"language-objc",children:"// Add the header at the top of the file:\n#import <React/RCTLinkingManager.h>\n\n// Add this inside `@implementation AppDelegate` above `@end`:\n- (BOOL)application:(UIApplication *)application\n   openURL:(NSURL *)url\n   options:(NSDictionary<UIApplicationOpenURLOptionsKey,id> *)options\n{\n  return [RCTLinkingManager application:application openURL:url options:options];\n}\n"})}),"\n",(0,o.jsx)(n.p,{children:"If you're targeting iOS 8.x or older, you can use the following code instead:"}),"\n",(0,o.jsx)(n.pre,{children:(0,o.jsx)(n.code,{className:"language-objc",children:"// Add the header at the top of the file:\n#import <React/RCTLinkingManager.h>\n\n// Add this inside `@implementation AppDelegate` above `@end`:\n- (BOOL)application:(UIApplication *)application openURL:(NSURL *)url\n  sourceApplication:(NSString *)sourceApplication annotation:(id)annotation\n{\n  return [RCTLinkingManager application:application openURL:url\n                      sourceApplication:sourceApplication annotation:annotation];\n}\n"})}),"\n",(0,o.jsx)(n.p,{children:"If your app is using Universal Links, you'll need to add the following code as well:"}),"\n",(0,o.jsx)(n.pre,{children:(0,o.jsx)(n.code,{className:"language-objc",children:"// Add this inside `@implementation AppDelegate` above `@end`:\n- (BOOL)application:(UIApplication *)application continueUserActivity:(nonnull NSUserActivity *)userActivity\n restorationHandler:(nonnull void (^)(NSArray<id<UIUserActivityRestoring>> * _Nullable))restorationHandler\n{\n return [RCTLinkingManager application:application\n                  continueUserActivity:userActivity\n                    restorationHandler:restorationHandler];\n}\n"})}),"\n",(0,o.jsx)(n.p,{children:"Now you need to add the scheme to your project configuration."}),"\n",(0,o.jsxs)(n.p,{children:["The easiest way to do this is with the ",(0,o.jsx)(n.code,{children:"uri-scheme"})," package: ",(0,o.jsx)(n.code,{children:"npx uri-scheme add example --ios"}),"."]}),"\n",(0,o.jsxs)(n.p,{children:["If you want to do it manually, open the project at ",(0,o.jsx)(n.code,{children:"SimpleApp/ios/SimpleApp.xcodeproj"}),' in Xcode. Select the project in sidebar and navigate to the info tab. Scroll down to "URL Types" and add one. In the new URL type, set the identifier and the URL scheme to your desired URL scheme.']}),"\n",(0,o.jsx)(n.p,{children:(0,o.jsx)(n.img,{alt:"Xcode project info URL types with example added",src:i(40801).Z+"",width:"1098",height:"560"})}),"\n",(0,o.jsx)(n.p,{children:"Now you can press play in Xcode, or re-build on the command line:"}),"\n",(0,o.jsx)(n.pre,{children:(0,o.jsx)(n.code,{className:"language-bash",children:"npx react-native run-ios\n"})}),"\n",(0,o.jsx)(n.p,{children:"To test the URI on the simulator, run the following:"}),"\n",(0,o.jsx)(n.pre,{children:(0,o.jsx)(n.code,{className:"language-bash",children:"npx uri-scheme open example://chat/jane --ios\n"})}),"\n",(0,o.jsxs)(n.p,{children:["or use ",(0,o.jsx)(n.code,{children:"xcrun"})," directly:"]}),"\n",(0,o.jsx)(n.pre,{children:(0,o.jsx)(n.code,{className:"language-bash",children:"xcrun simctl openurl booted example://chat/jane\n"})}),"\n",(0,o.jsxs)(n.p,{children:["To test the URI on a real device, open Safari and type ",(0,o.jsx)(n.code,{children:"example://chat/jane"}),"."]}),"\n",(0,o.jsx)(n.h3,{id:"android",children:"Android"}),"\n",(0,o.jsx)(n.p,{children:"To configure the external linking in Android, you can create a new intent in the manifest."}),"\n",(0,o.jsxs)(n.p,{children:["The easiest way to do this is with the ",(0,o.jsx)(n.code,{children:"uri-scheme"})," package: ",(0,o.jsx)(n.code,{children:"npx uri-scheme add example --android"}),"."]}),"\n",(0,o.jsxs)(n.p,{children:["If you want to add it manually, open up ",(0,o.jsx)(n.code,{children:"SimpleApp/android/app/src/main/AndroidManifest.xml"}),", and make the following adjustments:"]}),"\n",(0,o.jsxs)(n.ol,{children:["\n",(0,o.jsxs)(n.li,{children:["Set ",(0,o.jsx)(n.code,{children:"launchMode"})," of ",(0,o.jsx)(n.code,{children:"MainActivity"})," to ",(0,o.jsx)(n.code,{children:"singleTask"})," in order to receive intent on existing ",(0,o.jsx)(n.code,{children:"MainActivity"})," (this is the default on all new projects, so you may not need to actually change anything!). It is useful if you want to perform navigation using deep link you have been registered - ",(0,o.jsx)(n.a,{href:"http://developer.android.com/training/app-indexing/deep-linking.html#adding-filters",children:"details"})]}),"\n",(0,o.jsxs)(n.li,{children:["Add the new ",(0,o.jsx)(n.code,{children:"intent-filter"})," inside the ",(0,o.jsx)(n.code,{children:"MainActivity"})," entry with a ",(0,o.jsx)(n.code,{children:"VIEW"})," type action:"]}),"\n"]}),"\n",(0,o.jsx)(n.pre,{children:(0,o.jsx)(n.code,{className:"language-xml",children:'<activity\n    android:name=".MainActivity"\n    android:launchMode="singleTask">\n    <intent-filter>\n        <action android:name="android.intent.action.MAIN" />\n        <category android:name="android.intent.category.LAUNCHER" />\n    </intent-filter>\n    <intent-filter>\n        <action android:name="android.intent.action.VIEW" />\n        <category android:name="android.intent.category.DEFAULT" />\n        <category android:name="android.intent.category.BROWSABLE" />\n        <data android:scheme="example" />\n    </intent-filter>\n</activity>\n'})}),"\n",(0,o.jsx)(n.p,{children:"Now, re-install the app:"}),"\n",(0,o.jsx)(n.pre,{children:(0,o.jsx)(n.code,{className:"language-bash",children:"react-native run-android\n"})}),"\n",(0,o.jsx)(n.p,{children:"To test the intent handling in Android, run the following:"}),"\n",(0,o.jsx)(n.pre,{children:(0,o.jsx)(n.code,{className:"language-bash",children:"npx uri-scheme open example://chat/jane --android\n"})}),"\n",(0,o.jsxs)(n.p,{children:["or use ",(0,o.jsx)(n.code,{children:"adb"})," directly:"]}),"\n",(0,o.jsx)(n.pre,{children:(0,o.jsx)(n.code,{className:"language-bash",children:'adb shell am start -W -a android.intent.action.VIEW -d "example://chat/jane" com.simpleapp\n'})}),"\n",(0,o.jsx)(n.h2,{id:"hybrid-react-native-and-native-ios-applications-skip-for-react-native-only-projects",children:"Hybrid React Native and native iOS Applications (skip for React-Native-only projects)"}),"\n",(0,o.jsxs)(n.p,{children:["If you're using React Navigation within a hybrid app - an iOS app that has both Swift/ObjC and React Native parts - you may be missing the ",(0,o.jsx)(n.code,{children:"RCTLinkingIOS"})," subspec in your Podfile, which is installed by default in new RN projects. To add this, ensure your Podfile looks like the following:"]}),"\n",(0,o.jsx)(n.pre,{children:(0,o.jsx)(n.code,{className:"language-pod",children:" pod 'React', :path => '../node_modules/react-native', :subspecs => [\n    . . . // other subspecs\n    'RCTLinkingIOS',\n    . . .\n  ]\n"})}),"\n",(0,o.jsx)(n.h2,{id:"third-party-integrations",children:"Third-party integrations"}),"\n",(0,o.jsxs)(n.p,{children:["React Native's ",(0,o.jsx)(n.code,{children:"Linking"})," isn't the only way to handle deep linking. You might also want to integrate other services such as ",(0,o.jsx)(n.a,{href:"https://help.branch.io/developers-hub/docs/react-native",children:"Branch"})," which provide their own API for getting notified of incoming links, or you also might want to handle links from push notifications using ",(0,o.jsx)(n.a,{href:"https://rnfirebase.io/messaging/notifications",children:"Firebase"})," etc."]}),"\n",(0,o.jsxs)(n.p,{children:["To achieve this, you'd need to override how React Navigation subscribes to incoming links. To do so, you can provide your own ",(0,o.jsx)(n.a,{href:"/docs/5.x/navigation-container#linkinggetinitialurl",children:(0,o.jsx)(n.code,{children:"getInitialURL"})})," and ",(0,o.jsx)(n.a,{href:"/docs/5.x/navigation-container#linkingsubscribe",children:(0,o.jsx)(n.code,{children:"subscribe"})})," functions:"]}),"\n",(0,o.jsx)(n.pre,{children:(0,o.jsx)(n.code,{className:"language-js",children:"const linking = {\n  prefixes: ['myapp://', 'https://myapp.com'],\n\n  // Custom function to get the URL which was used to open the app\n  async getInitialURL() {\n    // First, you may want to do the default deep link handling\n    // Check if app was opened from a deep link\n    const url = await Linking.getInitialURL();\n\n    if (url != null) {\n      return url;\n    }\n\n    // Next, you would need to get the initial URL from your third-party integration\n    // It depends on the third-party SDK you use\n    // For example, to get the initial URL for branch.io:\n    const params = branch.getFirstReferringParams();\n\n    return params?.$canonical_url;\n  },\n\n  // Custom function to subscribe to incoming links\n  subscribe(listener) {\n    // First, you may want to do the default deep link handling\n    const onReceiveURL = ({ url }: { url: string }) => listener(url);\n\n    // Listen to incoming links from deep linking\n    Linking.addEventListener('url', onReceiveURL);\n\n    // Next, you would need to subscribe to incoming links from your third-party integration\n    // For example, to get to subscribe to incoming links from branch.io:\n    branch.subscribe(({ error, params, uri }) => {\n      if (error) {\n        console.error('Error from Branch: ' + error);\n        return;\n      }\n\n      if (params['+non_branch_link']) {\n        const nonBranchUrl = params['+non_branch_link'];\n        // Route non-Branch URL if appropriate.\n        return;\n      }\n\n      if (!params['+clicked_branch_link']) {\n        // Indicates initialization success and some other conditions.\n        // No link was opened.\n        return;\n      }\n\n      // A Branch link was opened\n      const url = params.$canonical_url;\n\n      listener(url);\n    });\n    );\n\n    return () => {\n      // Clean up the event listeners\n      Linking.removeEventListener('url', onReceiveURL);\n      branch.unsubscribe();\n    };\n  },\n\n  config: {\n    // Deep link configuration\n  }\n};\n"})}),"\n",(0,o.jsxs)(n.p,{children:["Similar to the above example, you can integrate any API that provides a way to get the initial URL and to subscribe to new incoming URLs using the ",(0,o.jsx)(n.code,{children:"getInitialURL"})," and ",(0,o.jsx)(n.code,{children:"subscribe"})," options."]})]})}function p(e={}){let{wrapper:n}={...(0,a.a)(),...e.components};return n?(0,o.jsx)(n,{...e,children:(0,o.jsx)(c,{...e})}):c(e)}},40801:function(e,n,i){i.d(n,{Z:function(){return t}});let t=i.p+"assets/images/xcode-linking-9a32c91fae982fab28dc33e7f951e8b3.png"},50065:function(e,n,i){i.d(n,{Z:function(){return s},a:function(){return r}});var t=i(67294);let o={},a=t.createContext(o);function r(e){let n=t.useContext(a);return t.useMemo(function(){return"function"==typeof e?e(n):{...n,...e}},[n,e])}function s(e){let n;return n=e.disableParentContext?"function"==typeof e.components?e.components(o):e.components||o:r(e.components),t.createElement(a.Provider,{value:n},e.children)}}}]);